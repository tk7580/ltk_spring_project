<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout/default_layout}">
<head>
  <title th:text="${dto.article.title} + ' - PlotPath'"></title>
  <th:block layout:fragment="css">
    <style>
      .article-container { max-width: 800px; margin: 20px auto; padding: 30px; background-color: #fff; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
      .article-header { border-bottom: 1px solid #eee; padding-bottom: 15px; margin-bottom: 25px; }
      .article-header h1 { font-size: 28px; margin-bottom: 10px; }
      .article-meta-info { display: flex; justify-content: space-between; align-items: center; color: #666; font-size: 14px; }
      .article-body { font-size: 16px; line-height: 1.8; min-height: 150px; padding: 20px 0; }
      .article-actions { display: flex; justify-content: center; gap: 20px; padding: 20px; border-top: 1px solid #f0f0f0; }
      .action-btn { display: flex; align-items: center; gap: 8px; padding: 8px 15px; border: 1px solid #ccc; border-radius: 20px; text-decoration: none; font-size: 14px; color: #333; cursor: pointer; }
      .action-btn:hover { background-color: #f5f5f5; }
      .action-btn svg { width: 18px; height: 18px; }

      .comment-section { margin-top: 40px; }
      .comment-section h3 { font-size: 20px; border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 20px; }
      .comment-form textarea { width: 100%; height: 80px; padding: 10px; border: 1px solid #ccc; border-radius: 5px; resize: vertical; box-sizing: border-box; }
      .comment-form .btn-submit { display: block; width: 100px; margin-left: auto; margin-top: 10px; padding: 10px; background-color: #333; color: #fff; border: none; border-radius: 5px; cursor: pointer; }

      .comment-list ul { list-style: none; padding: 0; }
      .comment-item { padding: 15px 0; border-top: 1px solid #eee; }
      .comment-item .comment-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
      .comment-item .comment-author { font-weight: bold; }
      .comment-item .comment-date { font-size: 13px; color: #888; }
      .comment-item .comment-body { margin-bottom: 10px; }
      .comment-item .comment-actions { font-size: 13px; }
      .comment-item .comment-actions a { color: #555; text-decoration: none; margin-right: 10px; }
      .comment-item.child-comment { margin-left: 40px; border-top: 1px dashed #ddd; }
    </style>
  </th:block>
</head>
<body>
<th:block layout:fragment="content">
  <main class="main-content">
    <div class="article-container">
      <header class="article-header">
        <h1 th:text="${dto.article.title}">게시글 제목</h1>
        <div class="article-meta-info">
          <span class="author" th:text="${dto.article.member.nickname}">작성자</span>
          <span class="date" th:text="${#temporals.format(dto.article.regDate, 'yyyy-MM-dd HH:mm')}">작성일</span>
        </div>
      </header>
      <div class="article-body" th:text="${dto.article.body}">
        게시글 내용이 여기에 표시됩니다.
      </div>

      <div class="article-actions">
        <a href="#" class="action-btn btn-like">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path></svg>
          <span>좋아요</span>
          <span th:text="${dto.article.goodReactionPoint}">0</span>
        </a>
        <a href="#" class="action-btn btn-dislike">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 15v7a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path></svg>
          <span>싫어요</span>
          <span th:text="${dto.article.badReactionPoint}">0</span>
        </a>
      </div>

      <section class="comment-section">
        <h3>댓글</h3>
        <div class="comment-list">
          <ul>
            <th:block th:each="comment : ${dto.comments}">
              <li th:replace="~{article/detail :: commentFragment(${comment})}"></li>
            </th:block>
          </ul>
        </div>
        <form th:action="@{/series/{seriesId}/board/{articleId}/replies(seriesId=${series.id}, articleId=${dto.article.id})}" method="post" class="comment-form">
          <textarea name="body" placeholder="댓글을 남겨보세요."></textarea>
          <button type="submit" class="btn-submit">등록</button>
        </form>
      </section>
    </div>
  </main>

  <th:block th:fragment="commentFragment(comment)">
    <li class="comment-item" th:classappend="${comment.parent != null} ? 'child-comment'">
      <div class="comment-header">
        <span class="comment-author" th:text="${comment.member.nickname}"></span>
        <span class="comment-date" th:text="${#temporals.format(comment.regDate, 'yyyy.MM.dd HH:mm')}"></span>
      </div>
      <div class="comment-body" th:text="${comment.body}"></div>
      <div class="comment-actions">
        <a href="#">답글</a>
      </div>
      <ul th:if="${!#lists.isEmpty(comment.children)}">
        <li th:each="child : ${comment.children}" th:replace="~{article/detail :: commentFragment(${child})}"></li>
      </ul>
    </li>
  </th:block>

</th:block>
</body>
</html>